{
	"info": {
		"_postman_id": "6ea405a2-6cae-4a88-8231-b8a972e0ad01",
		"name": "Sample Retail APIs",
		"description": "Order to run:\r\n\r\n1. Create Sites\r\n2. Create Categories\r\n3. Create Items\r\n4. Create Item Prices\r\n5. Create Item Attributes",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "1: Create Sites",
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"id": "ca5d85f0-42d9-4b60-8418-c96bd516006c",
						"exec": [
							""
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "test",
					"script": {
						"id": "866aa11d-0111-4f7a-b3f3-37412e3a5f90",
						"exec": [
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json",
						"type": "text"
					},
					{
						"key": "Authorization",
						"value": "{{bsp-access-key}}",
						"type": "text"
					},
					{
						"key": "nep-organization",
						"value": "{{bsp-organization}}",
						"type": "text"
					},
					{
						"key": "Date",
						"value": "{{date}}",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"sites\": {{create-sites}}\n}"
				},
				"url": {
					"raw": "{{site-service}}/sites/import",
					"host": [
						"{{site-service}}"
					],
					"path": [
						"sites",
						"import"
					]
				},
				"description": "https://developer.ncr.com/portals/dev-portal/api-explorer/details/15/documentation?version=1.99&path=post_sites_import"
			},
			"response": []
		},
		{
			"name": "2: Create Categories",
			"event": [
				{
					"listen": "test",
					"script": {
						"id": "eba85795-3592-42cc-be8b-99c42aa82761",
						"exec": [
							""
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"id": "2afc60d2-f206-4768-92da-1ed7971697d6",
						"exec": [
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "PUT",
				"header": [
					{
						"key": "Content-Type",
						"type": "text",
						"value": "application/json"
					},
					{
						"key": "Authorization",
						"type": "text",
						"value": "{{bsp-access-key}}"
					},
					{
						"key": "nep-organization",
						"type": "text",
						"value": "{{bsp-organization}}"
					},
					{
						"key": "Date",
						"type": "text",
						"value": "{{date}}"
					},
					{
						"key": "Accept",
						"type": "text",
						"value": "application/json"
					},
					{
						"key": "Accept-Language",
						"type": "text",
						"value": "en-us"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"nodes\": {{create-categories}}\n}"
				},
				"url": {
					"raw": "{{catalog-service}}/category-nodes",
					"host": [
						"{{catalog-service}}"
					],
					"path": [
						"category-nodes"
					]
				},
				"description": "https://developer.ncr.com/portals/dev-portal/api-explorer/details/8/documentation?version=2.99&path=put_category-nodes"
			},
			"response": []
		},
		{
			"name": "3: Create Items",
			"event": [
				{
					"listen": "test",
					"script": {
						"id": "ecf25cf3-b9e2-470c-a608-483aa1b1b465",
						"exec": [
							""
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"id": "eae6988b-920b-4c6e-a9fe-999dd7e4b29b",
						"exec": [
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "PUT",
				"header": [
					{
						"key": "Content-Type",
						"type": "text",
						"value": "application/json"
					},
					{
						"key": "Authorization",
						"type": "text",
						"value": "{{bsp-access-key}}"
					},
					{
						"key": "nep-organization",
						"type": "text",
						"value": "{{bsp-organization}}"
					},
					{
						"key": "Date",
						"type": "text",
						"value": "{{date}}"
					},
					{
						"key": "Accept",
						"type": "text",
						"value": "application/json"
					},
					{
						"key": "Accept-Language",
						"type": "text",
						"value": "en-us"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"items\": {{create-items}}\n}"
				},
				"url": {
					"raw": "{{catalog-service}}/items",
					"host": [
						"{{catalog-service}}"
					],
					"path": [
						"items"
					]
				},
				"description": "https://developer.ncr.com/portals/dev-portal/api-explorer/details/8/documentation?version=2.99&path=put_items"
			},
			"response": []
		},
		{
			"name": "4: Create Item Prices",
			"event": [
				{
					"listen": "test",
					"script": {
						"id": "2c366d9b-c3e3-47af-b567-11caa76de025",
						"exec": [
							""
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"id": "2a0899e3-c1a5-4116-adf4-b86895fbb389",
						"exec": [
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "PUT",
				"header": [
					{
						"key": "Content-Type",
						"type": "text",
						"value": "application/json"
					},
					{
						"key": "Authorization",
						"type": "text",
						"value": "{{bsp-access-key}}"
					},
					{
						"key": "nep-organization",
						"type": "text",
						"value": "{{bsp-organization}}"
					},
					{
						"key": "Date",
						"type": "text",
						"value": "{{date}}"
					},
					{
						"key": "Accept",
						"type": "text",
						"value": "application/json"
					},
					{
						"key": "Accept-Language",
						"type": "text",
						"value": "en-us"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"itemPrices\": {{create-item-prices}}\n}"
				},
				"url": {
					"raw": "{{catalog-service}}/item-prices",
					"host": [
						"{{catalog-service}}"
					],
					"path": [
						"item-prices"
					]
				},
				"description": "https://developer.ncr.com/portals/dev-portal/api-explorer/details/8/documentation?version=2.99&path=put_item-prices"
			},
			"response": []
		},
		{
			"name": "5: Create Item Attributes",
			"event": [
				{
					"listen": "test",
					"script": {
						"id": "6c74f44f-24d0-4db9-86f3-cd5b3ab563a9",
						"exec": [
							""
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"id": "5dd490ad-b436-407d-adf4-b70bafe5938d",
						"exec": [
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "PUT",
				"header": [
					{
						"key": "Content-Type",
						"type": "text",
						"value": "application/json"
					},
					{
						"key": "Authorization",
						"type": "text",
						"value": "{{bsp-access-key}}"
					},
					{
						"key": "nep-organization",
						"type": "text",
						"value": "{{bsp-organization}}"
					},
					{
						"key": "Date",
						"type": "text",
						"value": "{{date}}"
					},
					{
						"key": "Accept",
						"type": "text",
						"value": "application/json"
					},
					{
						"key": "Accept-Language",
						"type": "text",
						"value": "en-us"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"itemAttributes\": {{create-item-attributes}}\n}"
				},
				"url": {
					"raw": "{{catalog-service}}/item-attributes",
					"host": [
						"{{catalog-service}}"
					],
					"path": [
						"item-attributes"
					]
				},
				"description": "https://developer.ncr.com/portals/dev-portal/api-explorer/details/8/documentation?version=2.99&path=put_item-attributes"
			},
			"response": []
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"id": "a96f2912-9a22-4908-88d6-f8e29fc8494b",
				"type": "text/javascript",
				"exec": [
					"//Services for products should be added here",
					"postman.setEnvironmentVariable(\"site-service\", \"https://gateway-staging.ncrcloud.com/site\");",
					"postman.setEnvironmentVariable(\"catalog-service\",\"https://gateway-staging.ncrcloud.com/catalog/\");",
					"",
					"// Any required fields for a call should be added here",
					"postman.setEnvironmentVariable(\"bsp-organization\", \"f5bcae3c8b784b3f948e3de3757cdea0\");",
					"postman.setEnvironmentVariable(\"bsp-shared-key\", \"0f69e177ee0e433c9e8e606d428f65a5\");",
					"postman.setEnvironmentVariable(\"bsp-secret-key\", \"b0723797c0c542fba70106cfa3d60f46\");",
					"",
					"// Ensures any content has variables substituted; supports recursive",
					"// resolution (environment variable that references environment/global variables)",
					"const convertVariables = function(templateContent) {",
					"    const regexPattern = /({{(.*?)}})/g;",
					"    let convertedContent = templateContent;",
					"    let matchedVar = new RegExp(regexPattern).exec(convertedContent);",
					"    while (matchedVar !== null) {",
					"        const variableReplacement = matchedVar[1];",
					"        const variableName = matchedVar[2];",
					"        const variableValue = postman.getEnvironmentVariable(variableName) || postman.getGlobalVariable(variableName);",
					"        convertedContent = convertedContent.replace(variableReplacement, variableValue);",
					"        matchedVar = new RegExp(regexPattern).exec(convertedContent);",
					"    }",
					"    return convertedContent;",
					"}",
					"// Extracts the signable content from the request",
					"const signableContent = function() {",
					"    const requestPath = convertVariables(request.url.trim()).replace(/^https?:\\/\\/[^\\/]+\\//, '/');",
					"    const params = [",
					"        request.method,",
					"        requestPath,",
					"        request.headers['content-type'],",
					"        request.headers['content-md5'],",
					"        convertVariables(request.headers['nep-organization'])",
					"    ];",
					"    return params.filter(p => p && p.length > 0).join('\\n');",
					"}",
					"// Generates a unique date-based signing key",
					"const uniqueKey = function(date) {",
					"    const nonce = date.toISOString().slice(0, 19) + '.000Z';",
					"    return postman.getEnvironmentVariable('bsp-secret-key') + nonce;",
					"}",
					"// Calculates the HMAC signature",
					"const calculateSignature = function() {",
					"    const date = new Date();",
					"    postman.setEnvironmentVariable('date', date.toGMTString());",
					"    const key = uniqueKey(date);",
					"    const sc = signableContent();",
					"    const hmac = CryptoJS.HmacSHA512(sc, key);",
					"    return CryptoJS.enc.Base64.stringify(hmac);",
					"}",
					"// Stores the generated HMAC signature under the access key",
					"const signature = calculateSignature();",
					"const sharedKey = postman.getEnvironmentVariable('bsp-shared-key');",
					"postman.setEnvironmentVariable('bsp-access-key', `AccessKey ${sharedKey}:${signature}`);",
					"",
					"// Generated from export"
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"id": "d27a3b21-ccb4-46e5-8d17-27d1a9145d17",
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"protocolProfileBehavior": {}
}